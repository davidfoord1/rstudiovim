---
title: "rstudiovim"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rstudiovim}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

First, you need to know how to execute commands to create key bindings.

## Keybinding commands

RStudio offers a few commands for dealing with key bindings:
^[You can see more available commands by looking through the RStudio 
[default Ex Command map](https://github.com/rstudio/rstudio/blob/4f7063b13bb0bae8377639a36d3ff4b7626de6e3/src/gwt/src/org/rstudio/studio/client/workbench/views/source/editors/text/ace/keybinding-vim-uncompressed.js#L991C7-L991C26) on GitHub.]

- `imap` - insert mode.
- `nmap` - normal mode.
- `vmap` - visual mode.
- `map`  - for both normal and visual modes. 

`<map_command> <new_key_sequence> <keys_to_execute>`

So to bind home-row keys `jk` to exit from insert mode to normal mode, the 
command could be:

`imap jk <Esc>` 

### Executing commands

Assuming you already have Vim keybindings active in the RStudio source editor,
you can bring up Vim command mode from normal mode by pressing `:`, then type
your command and press `Enter` to execute it.

So starting in normal mode press the keys, you could apply the example
keybinding with `imap jk <Esc>`, in full pressing the keys `:` `i` `m` `a` `p`
`<Space>` `j` `k` `<Space>` `<` `E` `s` `c` `>` `<Enter>`.

## Applying {rstudiovim}

```{r setup}
library(rstudiovim)
```

### Troubleshooting

- First, the Vim implementation is quite limited, so always make sure the command
is one you can execute in RStudio yourself first. If it doesn't there's not much
{rstudiovim} can do about it.

- If something doesn't work that usually does, try restarting the R session and
executing your `rsvim_exec_file()` call again. Sometimes the execution gets 
interrupted by other processes.

- If a command works for you when you type itself, but doesn't seem to work with
{rstudiovim}, then there may be an issue in the parsing of your commands and 
translation to keypresses. There is an argument `wait` with which you can specify
seconds to wait between your commands being typed and then executed. In this way
you can review what is actually being typed. If you find a disparity between what
is being typed and what's in your .virmc, please raise (or add to a related) 
[GitHub issue](https://github.com/davidfoord1/rstudiovim/issues). You can use
`rsvim_exec()` for a single command if that helps you narrow the behaviour down.
